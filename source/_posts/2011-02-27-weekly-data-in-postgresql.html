---
layout: post
title: Weekly Data in PostgreSQL
published: false
---
<p>
<div style="color: #000000; font-family: Arial, Helvetica, sans-serif; font-size: 13px; background-color: #ffffff; margin: 8px;">
<p>Don't base your week definitions on only part of your data. Create your own. &nbsp;A&nbsp;year = 52 Weeks + 1.25 Days. Clearly not perfect.</p>
<p>Requirements:</p>
<p>-Weeks must be standard period of time (7 days)<br />-Must have access to week start date for set-based comparisons<br />-Must have access to week end date for set-based comparisons<br />-Must be able to order weeks in chronological order<br />-Non-shitty performance</p>
<p>Options:</p>
<p>1) Dynamically generate weeks from base table of data (likely massive tracking table) using to_char(timestamp, 'WW') or to_char(timestamp,'IW') to get Week or ISO Week of Year</p>
<p>2) Import ISO Standard table of weeks (source?)</p>
<p>3) Create MyWeeks (or general time periods) table and establish my own</p>
<p>Though option 1 is widely accepted as a shortcut (and, granted, it's pretty easy), let's look at the potential problems it presents:</p>
<p>-I fail to establish an independent, standard time frame over which to compare different data. All of my weekly data is then limited to the timeframe of the data set recorded in the monster table (e.g. if I based my weeks on a signup_tracking table then compared to events_tracking - I would miss events that happened during periods when no one signed up)</p>
<p>-Perhaps I have a growing web application that doesn't have a monster table of events quite yet</p>
<p>-And/Or that that I know it would suck to run a distinct/group by to get the unique weeks from that monster table anyway</p>
<p>Alas, as a righteous database programmer I must import from ISO (2) or create my own (3). Given that ISO means nothing to me and I can't seem to find a prepared list of dates, the ISO option becomes writing my own function to record ISO dates (fun:<a href="http://en.wikipedia.org/wiki/Seven-day_week#Week_numbering" target="_blank">http://en.wikipedia.org/wiki/Seven-day_week#Week_numbering</a>).&nbsp;</p>
<p>With options 2 and 3 demanding the same amount of effort, option 3 to create my own week structure seems the best bang for my buck. How to do this quickly in PostgreSQL?</p>
<p>As follows:</p>
<p>-Create table</p>
<p>-Populate first row</p>
<p>-Create function</p>
<p>-Add rows as desired by running function</p>
<p>How have you solved this problem?</p>
</div>
</p>
